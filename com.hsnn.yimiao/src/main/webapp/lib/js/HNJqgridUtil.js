function autoRNWidth(gridId){var page=$("#"+gridId).jqGrid("getGridParam","page");var rows=$("#"+gridId).getGridParam("rowNum");var maxnum=(rows*page).toString();var len=(maxnum.length)*10;$(".jqgfirstrow").find("td").eq(0).css("width",len+"px");$("#"+gridId+"_rn").css("width",len+"px");jqgridAutoWH()}function jqgridAutoWH(){if($(".jqgrid",".content").length>0){$(".ui-jqgrid-bdiv table,.ui-jqgrid-htable").css("width",$(".ui-jqgrid-bdiv table").width()-1);$(".null-line").css("height",$(".modal-footer").height()+14);var gPrevLen=$(".ui-jqgrid").prevAll().length;var jHeight=0;if(gPrevLen>1){for(var i=0;i<gPrevLen;i++){var j=$(".ui-jqgrid").prevAll().eq(i).height()+13;jHeight+=j}}else{jHeight=$(".ui-jqgrid").prevAll().height()+13}var tableHeight=$(window).height()-$(".content-header").height()-jHeight-$(".ui-jqgrid-titlebar").height()-$(".ui-jqgrid-hdiv").height()-$(".null-line").height();if($(".ui-jqgrid").parent(".content").length>0){if($(".ui-jqgrid + div.bottongroup").length>0){$(".ui-jqgrid-bdiv").css("height",tableHeight-$(".ui-jqgrid").nextAll().height()-66.59999999999999)}else{$(".ui-jqgrid-bdiv").css("height",tableHeight-52.6);if($(".ui-jqgrid").parent("section").prev("section.content").length>0){$(".ui-jqgrid-bdiv").css("height",tableHeight-($(".ui-jqgrid").parent("section").prev("section.content").height()+10)-($(".content-header").height()*2)-38.6)}else{if($(".ui-jqgrid").parent("section").prev("section.content-header").children(".divatab").length>0){$(".ui-jqgrid-bdiv").css("height",tableHeight-($(".ui-jqgrid").parent("section").prev("section.content-header").height()+10)-$(".content-header").height()-38.6)}else{if($(".ui-jqgrid").next().height()>0&&$(".ui-jqgrid").next().height()<=40){$(".ui-jqgrid-bdiv").css("height",tableHeight-$(".ui-jqgrid").next().height()-76.59999999999999)}else{$(".ui-jqgrid-bdiv").css("height",tableHeight-52.6)}}}}$(".jqgrid").jqGrid("setGridWidth",$(".content").width());$(".ui-jqgrid-bdiv table,.ui-jqgrid-htable").css("width",$(".ui-jqgrid-bdiv table").width()-1)}else{if($(".ui-jqgrid").parent(".box-body").length>0){$(".ui-jqgrid-bdiv").css("height",tableHeight-$(".ui-jqgrid-bdiv").parents(".box").prev().height()-($(".content-header").height()*2)-86.59999999999999);$(".jqgrid").jqGrid("setGridWidth",$(".box-body:first").width());$(".ui-jqgrid-bdiv table,.ui-jqgrid-htable").css("width",$(".ui-jqgrid-bdiv table").width()-1)}}}$(".ui-jqgrid-bdiv table,.ui-jqgrid-htable").css("width",$(".ui-jqgrid-bdiv table").width()-1);$(".width-control").css({"width":$(".ui-jqgrid").width()})}function selectByOneData(gridId){var num=$("#"+gridId).jqGrid("getGridParam","records");if(num==1){var ids=jQuery("#"+gridId).jqGrid("getDataIDs");$("#jqg_"+gridId+"_"+ids[0]).attr("checked",true);$("#"+gridId).jqGrid("setSelection",ids[0])}}function getGridColumValue(gridId,columName){var rowIds=$("#"+gridId).jqGrid("getGridParam","selarrrow");if(rowIds.length<1){return""}var str="";for(var i=0;i<rowIds.length;i++){var rowdata=$("#"+gridId).jqGrid("getRowData",rowIds[i]);str+=rowdata[columName]+","}if(str!=""){str=str.substring(0,str.length-1)}return str}function batchSwitchStatus(gridId,nameColum,statusColum,status,info){var rowIds=$("#"+gridId).jqGrid("getGridParam","selarrrow");if(rowIds.length<1){top.$.HN.message.alert("请选择要"+status+"的"+info,"","warn");return}var str="";var names="";var infos=new Array();var j=0;for(var i=0;i<rowIds.length;i++){var rowdata=$("#"+gridId).jqGrid("getRowData",rowIds[i]);var temp=rowdata[statusColum].replace(/<.*?>/ig,"");if(status!=temp){if(j<3){names+=rowdata[nameColum]+"<br/>";if(j==2){names+="..."}}str+=rowIds[i]+",";j++}}if(names!=""){names=names.substring(0,names.length-1);str=str.substring(0,str.length-1)}else{top.$.HN.message.alert("您选择的"+info+"已经是"+status+"状态","","warn");return}infos[0]=str;infos[1]=names;return infos}$(function(){$.extend($.jgrid.defaults,{mtype:"post",datatype:"json",autowidth:true,height:270,rowNum:10,rowList:[10,20,50,100],rownumbers:true,pager:"#gridpage",pginput:false,viewrecords:true,gridComplete:function(){var gridId=$(this).jqGrid("getGridParam","id");autoRNWidth(gridId);$(".ui-jqgrid-bdiv table,.ui-jqgrid-htable").css("width",$(".ui-jqgrid-bdiv table").width()-1);initJqgridKeyEvent()},onPaging:function(){var gridId=$(this).jqGrid("getGridParam","id");var records=$(this).jqGrid("getGridParam","records");var rowNum=$(this).jqGrid("getGridParam","rowNum");var page=$("#gridpage td[dir=ltr] input[class=ui-pg-input]").val();var pn=records%rowNum==0?records/rowNum:parseInt(records/rowNum)+1;if(page>pn){$("#"+gridId).setGridParam({page:pn}).trigger("reloadGrid")}}})});function Merger(gridName,CellName){var mya=$("#"+gridName+"").getDataIDs();var length=mya.length;for(var i=0;i<length;i++){var before=$("#"+gridName+"").jqGrid("getRowData",mya[i]);var rowSpanTaxCount=1;for(j=i+1;j<=length;j++){var end=$("#"+gridName+"").jqGrid("getRowData",mya[j]);if(before[CellName]==end[CellName]){rowSpanTaxCount++;$("#"+gridName+"").setCell(mya[j],CellName,"",{display:"none"})}else{rowSpanTaxCount=1;break}$("#"+CellName+""+mya[i]+"").attr("rowspan",rowSpanTaxCount)}}};